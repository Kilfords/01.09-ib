Домашнее задание к занятию "«Резервное копирование»" - Боковиков Илья студента
Инструкция по выполнению домашнего задания

    Сделайте fork данного репозитория к себе в Github и переименуйте его по названию или номеру занятия, например, https://github.com/имя-вашего-репозитория/git-hw или https://github.com/имя-вашего-репозитория/7-1-ansible-hw).
    Выполните клонирование данного репозитория к себе на ПК с помощью команды git clone.
    Выполните домашнее задание и заполните у себя локально этот файл README.md:
        впишите вверху название занятия и вашу фамилию и имя
        в каждом задании добавьте решение в требуемом виде (текст/код/скриншоты/ссылка)
        для корректного добавления скриншотов воспользуйтесь инструкцией "Как вставить скриншот в шаблон с решением
        при оформлении используйте возможности языка разметки md (коротко об этом можно посмотреть в инструкции по MarkDown)
    После завершения работы над домашним заданием сделайте коммит (git commit -m "comment") и отправьте его на Github (git push origin);
    Для проверки домашнего задания преподавателем в личном кабинете прикрепите и отправьте ссылку на решение в виде md-файла в вашем Github.
    Любые вопросы по выполнению заданий спрашивайте в чате учебной группы и/или в разделе “Вопросы по заданию” в личном кабинете.

Задание 1. СУБД
Кейс

Крупная строительная компания, которая также занимается проектированием и девелопментом, решила создать правильную архитектуру для работы с данными. Ниже представлены задачи, которые необходимо решить для каждой предметной области.

Какие типы СУБД, на ваш взгляд, лучше всего подойдут для решения этих задач и почему?

1.1. Бюджетирование проектов с дальнейшим формированием финансовых аналитических отчётов и прогнозирования рисков. СУБД должна гарантировать целостность и чёткую структуру данных.
Ответ : Тут нужен строгий порядок и целостность → значит реляционная СУБД (SQL).
Лучший выбор: PostgreSQL или Mysql (если денег девать некуда).
Почему: транзакции (ACID), нормализация данных, связи, целостность. Отлично подходят для аналитики и прогнозов.

1.1.* Хеширование стало занимать длительно время, какое API можно использовать для ускорения работы?
Подключить API кеширования

1.2. Под каждый девелоперский проект создаётся отдельный лендинг, и все данные по лидам стекаются в CRM к маркетологам и менеджерам по продажам. Какой тип СУБД лучше использовать для лендингов и для CRM? СУБД должны быть гибкими и быстрыми.
Ответ: Лендинги → данные простые: заявки, клики, формы. Тут идеально подходит NoSQL (документо-ориентированная), типа MongoDB. Она гибкая, быстро принимает данные, не требует строгой схемы.
CRM → тут уже сложнее: много связей (клиенты, сделки, менеджеры). Лучше реляционная СУБД (PostgreSQL/MySQL).

1.2.* Можно ли эту задачу закрыть одной СУБД? И если да, то какой именно СУБД и какой реализацией?
Да можно Postgresql c JSONB

1.3. Отдел контроля качества решил создать базу по корпоративным нормам и правилам, обучающему материалу и так далее, сформированную согласно структуре компании. СУБД должна иметь простую и понятную структуру.
Ответ: Здесь всё просто, документы, учебники, регламенты. Это больше иерархия и поиск.
Подходит: документо-ориентированная NoSQL (MongoDB) или даже готовые решения типа Wiki на PostgreSQL.

1.3.* Можно ли под эту задачу использовать уже существующую СУБД из задач выше и если да, то как лучше это реализовать? 
Ответ:Можно ли использовать старую БД? Да. Например, если CRM или Postgres уже есть, можно туда запихнуть таблицы/JSON со статьями и разрулить поиском.

1.4. Департамент логистики нуждается в решении задач по быстрому формированию маршрутов доставки материалов по объектам и распределению курьеров по маршрутам с доставкой документов. СУБД должна уметь быстро работать со связями.
Ответ: графовые СУБД

1.4.* Можно ли к этой СУБД подключить отдел закупок или для них лучше сформировать свою СУБД в связке с СУБД логистов?
Ответ: Postgres (финансы) + Neo4j (связи).

1.5.* Можно ли все перечисленные выше задачи решить, используя одну СУБД? Если да, то какую именно?
Ответ: 
Теоретически да: PostgreSQL.
Почему:строгий SQL для бюджета,JSONB для гибких данных (лендинги/CRM), можно хранить документы, расширения типа pgRouting помогают и с логистикой (хотя до Neo4j не дотягивает).

Практически: если компания хочет "по фэншую" и есть ресурсы → лучше комбо:
PostgreSQL (финансы + CRM + база знаний),
MongoDB (лендинги),
Neo4j (логистика)

Задание 2. Транзакции

2.1. Пользователь пополняет баланс счёта телефона, распишите пошагово, какие действия должны произойти для того, чтобы транзакция завершилась успешно. Ориентируйтесь на шесть действий.

2.1.* Какие действия должны произойти, если пополнение счёта телефона происходило бы через автоплатёж?

Ответ: 
2.1. Пополнение баланса вручную (6 шагов)

Запрос от пользователя

Чувак вбил номер телефона и сумму. Система проверила: номер валидный, сумма в пределах допустимого, денег на карте/кошельке хватает.

Создание транзакции в системе

В базе появляется запись: «Пополнение такого-то номера на такую-то сумму». Статус ставим В ОБРАБОТКЕ.

Списание денег

Через платёжный шлюз (банк, карта, кошелёк) списываются деньги. Если банк сказал «нет» → статус ОТКАЗАНО.

Зачисление у оператора связи

Система шлёт запрос оператору: «Зачисли на номер ХХХ сумму Y».

Оператор подтверждает зачисление. Если сбой — транзакция откатывается или ставится на повтор.

Фиксация результата

В базе обновляем статус на УСПЕШНО, сохраняем ID операции банка и ответ оператора.

Уведомление пользователя

Отправляем SMS/уведомление: «Баланс пополнен на ХХХ рублей». Всё красиво и прозрачно.

2.1. Пополнение через автоплатёж*

Тут почти то же самое, но добавляются шаги автоматизации:

Хранение данных автоплатежа

Пользователь заранее сохранил карту/кошелёк, согласился на автосписания, указал условия (например, «раз в месяц» или «если баланс ниже 100 руб.»).

Запуск по расписанию

Система сама проверяет условия (баланс, дата, лимиты). Если условие сработало — создаётся транзакция с типом АВТО.

Проверка и подтверждение

Дополнительно проверяется: карта активна, лимит не превышен, токен оплаты действителен.

Списание денег и зачисление у оператора

Всё то же, что при ручном пополнении: деньги списали, оператору передали, ждём подтверждение.

Результат и повторные попытки

Если всё ок — статус УСПЕШНО.

Если сбой (карта недоступна, оператор не ответил) → система пробует ещё раз через определённое время.

Уведомление

Пользователю прилетает сообщение: «Автоплатёж выполнен успешно» или «Не удалось списать, проверьте карту».

Задание 3. SQL vs NoSQL
3.1. Пять преимуществ SQL-систем:

Строгая структура данных (схема)
→ Все таблицы заранее описаны, легко поддерживать целостность, меньше бардака.

ACID-транзакции
→ Гарантия целостности: либо всё выполняется, либо ничего. Особенно важно для денег, учёта, бухгалтерии.

Сложные запросы (JOIN, GROUP BY, HAVING)
→ Можно объединять таблицы, строить отчёты и аналитику без костылей.

Стандартизация
→ SQL понимают почти все админы и разработчики. Легко найти спеца и мигрировать между СУБД.

Зрелая экосистема
→ Тонны инструментов: бэкапы, мониторинг, репликация, оптимизация, интеграции. NoSQL в этом плане ещё «подростки».
3.1. Преимущества NewSQL перед SQL и NoSQL:*

NewSQL = SQL + масштабируемость от NoSQL.

Горизонтальное масштабирование, как у NoSQL
→ Можно разнести базу на десятки/сотни серверов без потери скорости.

Сохраняют ACID, как у SQL
→ В отличие от NoSQL, здесь данные не «поплывут» при нагрузках.

Привычный SQL-интерфейс
→ Не нужно учить новые языки запросов, всё тот же SQL.

Высокая производительность на больших нагрузках
→ Подходят и для транзакционных систем (OLTP), и для аналитики (OLAP).

Универсальность
→ Там, где раньше приходилось склеивать SQL + NoSQL, можно закрыть одной NewSQL.

Примеры NewSQL: Google Spanner, CockroachDB, TiDB.

Задание 4. Кластеры

У нас есть 1000 машин и огромные данные + вычисления. Вопрос: какую СУБД и модель выбрать?

Критерий выбора СУБД

Тип нагрузки: если нужно много вычислений на огромных массивах → лучше распределённая СУБД с поддержкой параллельных вычислений.

Горизонтальное масштабирование обязательно → SQL-классические базы не потянут, нужно или NoSQL, или NewSQL, или специализированные системы для Big Data.

Баланс между скоростью и целостностью: если критична точность (финансы, отчёты) → NewSQL, если нужны тупо быстрые расчёты (аналитика, big data) → NoSQL (HBase, Cassandra) или Spark.

Модель распределённых вычислений

Лучше всего зайдут:

MapReduce (Hadoop)

Старый, но проверенный метод. Делит задачу на куски (map), считает параллельно на сотнях машин, потом собирает результат (reduce).

In-memory распределённые фреймворки (Apache Spark, Flink)

Быстрее Hadoop, потому что работают в памяти. Подходят для real-time аналитики, стриминга данных.

MPP (Massively Parallel Processing) базы

Greenplum, ClickHouse, Teradata. Делят данные между узлами и выполняют запросы параллельно. Отлично для аналитических запросов на петабайтах данных.




